!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(require("jquery")):"function"==typeof define&&define.amd?define(["jquery"],e):e((t=t||self).jQuery)}(this,function(c){"use strict";function W(e,n,i){Object.keys(n).forEach(function(t){n[t]&&e.push(function(t,e){var n=e.tc,i=e.lc,s=e.x1c,o=e.y1c,a=e.t,r=e.b,h=e.l,p=e.r,f=e.x1,c=e.x2,l=e.y1,d=e.y2,v=e.margins,u=e.snapMargins;switch(t){case"tcs":return[{x:Math.min(i,s),y:n},{x:Math.max(i,s),y:n},i-s<0?u:v];case"lcs":return[{x:i,y:Math.min(n,o)},{x:i,y:Math.max(n,o)},n-o<0?u:v];case"ts":return[{x:Math.min(h,f),y:a},{x:Math.max(p,c),y:a},h-f<0?u:v];case"bs":return[{x:Math.min(h,f),y:r},{x:Math.max(p,c),y:r},h-f<0?u:v];case"ls":return[{x:h,y:Math.min(a,l)},{x:h,y:Math.max(r,d)},a-l<0?u:v];case"rs":default:return[{x:p,y:Math.min(a,l)},{x:p,y:Math.max(r,d)},a-l<0?u:v]}}(t,i))})}function l(t){return{left:parseInt(t.css("marginLeft"),10)||0,top:parseInt(t.css("marginTop"),10)||0,right:parseInt(t.css("marginRight"),10)||0,bottom:parseInt(t.css("marginBottom"),10)||0}}function B(t,e,n,i){for(var s=[],o=arguments.length-4;0<o--;)s[o]=arguments[o+4];(!t[e]||t[e].distance>n)&&(t[e]={distance:n,cb:i,args:s,snap:!0})}function q(t,e){return-1!==t.indexOf(e)}(c=c&&c.hasOwnProperty("default")?c.default:c).ui.plugin.add("draggable","snapRef",{start:function(t,e,n){var i,s=n.options;void 0===s&&(s={});var o=s,a=o.snapRef,r=o.snapRefLineColor;void 0===r&&(r="red");var h=o.snapCanvasZIndex;if(void 0===h&&(h=10001),a){n.snapRefElements=[];var p=this.parent();i=c("<canvas />").attr({width:p.width(),height:p.height()}).addClass("ui-snap-ref-canvas").css({position:"absolute",top:0,left:0,zIndex:h,"pointer-events":"none"}),n.canvas=i[0],p.append(n.canvas);var f=n.canvas.getContext("2d");(n.refLineContext=f).strokeStyle=r,c(a.constructor!==String?a.items||":data(ui-draggable)":a).each(function(){var t=c(this),e=t.offset();this!==n.element[0]&&n.snapRefElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e.top,left:e.left,margins:l(t)})})}},drag:function(t,e,n){var i=n.options,s=n.margins,o=i.snapRefTolerance;void 0===o&&(o=30);var a=i.snapTolerance||20;o<a&&(a=o);for(var r=e.offset.left,h=r+n.helperProportions.width,p=e.offset.top,f=p+n.helperProportions.height,c=r+Math.round(n.helperProportions.width/2),l=p+Math.round(n.helperProportions.height/2),d=[],v={},u=n.snapRefElements.length-1;0<=u;u-=1){var g=n.snapRefElements[u],m=g.left-s.left,b=m+g.width,M=g.top-s.top,w=M+g.height,x=M+Math.round(g.height/2),y=m+Math.round(g.width/2),z=g.margins,P=void 0,R=void 0,T=void 0,E=void 0,C=void 0,_=void 0,L=void 0,j=void 0,k=Math.abs(x-l),I=k<=o,O=Math.abs(y-c),S=O<=o;W(d,{tcs:I,lcs:S},{tc:x,lc:y,x1c:c,y1c:l,margins:s,snapMargins:z}),I&&k<=a&&B(v,"tcs",k,function(t){e.position.top=n._convertPositionTo("relative",{top:t-Math.round(n.helperProportions.height/2),left:0}).top},x),S&&O<=a&&B(v,"lcs",O,function(t){e.position.left=n._convertPositionTo("relative",{top:0,left:t-Math.round(n.helperProportions.width/2)}).left},y),"inner"!==i.snapRefMode&&(W(d,{ts:P=(C=Math.abs(M-f))<=o,bs:R=(_=Math.abs(w-p))<=o,ls:T=(L=Math.abs(m-h))<=o,rs:E=(j=Math.abs(b-r))<=o},{t:M,b:w,l:m,r:b,x1:r,x2:h,y1:p,y2:f,margins:s,snapMargins:z}),P&&C<=a&&B(v,"ts",C,function(t){e.position.top=n._convertPositionTo("relative",{top:t-n.helperProportions.height,left:0}).top},M),R&&_<=a&&B(v,"bs",_,function(t){e.position.top=n._convertPositionTo("relative",{top:t,left:0}).top},w),T&&L<=a&&B(v,"ls",L,function(t){e.position.left=n._convertPositionTo("relative",{top:0,left:t-n.helperProportions.width}).left},m),E&&j<=a&&B(v,"rs",j,function(t){e.position.left=n._convertPositionTo("relative",{top:0,left:t}).left},b)),"outer"!==i.snapRefMode&&(W(d,{ts:P=(C=Math.abs(M-p))<=o,bs:R=(_=Math.abs(w-f))<=o,ls:T=(L=Math.abs(m-r))<=o,rs:E=(j=Math.abs(b-h))<=o},{t:M,b:w,l:m,r:b,x1:r,x2:h,y1:p,y2:f,margins:s,snapMargins:z}),P&&C<=a&&B(v,"ts2",C,function(t){e.position.top=n._convertPositionTo("relative",{top:t,left:0}).top},M),R&&_<=a&&B(v,"bs2",_,function(t){e.position.top=n._convertPositionTo("relative",{top:t-n.helperProportions.height,left:0}).top},w),T&&L<=a&&B(v,"ls2",L,function(t){e.position.left=n._convertPositionTo("relative",{top:0,left:t}).left},m),E&&j<=a&&B(v,"rs2",j,function(t){e.position.left=n._convertPositionTo("relative",{top:0,left:t-n.helperProportions.width}).left},b))}Object.keys(v).forEach(function(t){var e=v[t];e.cb.apply(e,e.args)});var q=n.refLineContext,H=n.offset.parent;q.clearRect(0,0,n.canvas.width,n.canvas.height),q.beginPath(),d.forEach(function(t){var e=t[0],n=t[1],i=t[2];q.moveTo(e.x+i.left-H.left,e.y+i.top-H.top),q.lineTo(n.x+i.left-H.left,n.y+i.top-H.top)}),q.stroke()},stop:function(t,e,n){delete n.refLineContext,c(n.canvas).remove(),delete n.canvas}}),c.ui.plugin.add("resizable","snapRef",{start:function(){var t,e=c(this).resizable("instance"),n=e.options;void 0===n&&(n={});var i=n,s=i.snapRef,o=i.snapRefLineColor;if(void 0===o&&(o="red"),s){e.snapRefElements=[];var a=this.parent();t=c("<canvas />").attr({width:a.width(),height:a.height()}).css({position:"absolute",left:0,right:0,zIndex:10001,"pointer-events":"none"}),e.canvas=t[0],a.append(e.canvas);var r=e.canvas.getContext("2d");(e.refLineContext=r).strokeStyle=o,e.margins=l(e.element),e.helperProportions={width:e.element.outerWidth(),height:e.element.outerHeight()},c(s.constructor!==String?s.items||":data(ui-draggable)":s).each(function(){var t=c(this);this!==e.element[0]&&e.snapRefElements.push({item:this,width:t.outerWidth(),height:t.outerHeight(),top:e._num(t.css("top")),left:e._num(t.css("left")),margins:l(t)})})}},resize:function(t,e){var y=c(this).resizable("instance"),z=y.options,P=y.margins,R=y.axis,T=z.snapRefTolerance;void 0===T&&(T=30);var E=z.snapTolerance||20;T<E&&(E=T);for(var C=e.position.left,_=C+e.size.width,L=e.position.top,j=L+e.size.height,k=C+Math.round(e.size.width/2),I=L+Math.round(e.size.height/2),O=[],S=[],n=function(t){var e=y.snapRefElements[t],n=e.left-P.left,i=n+e.width,s=e.top-P.top,o=s+e.height,a=s+Math.round(e.height/2),r=n+Math.round(e.width/2),h=e.margins,p=void 0,f=void 0,c=void 0,l=void 0,d=void 0,v=void 0,u=void 0,g=void 0,m=void 0,b=void 0,M=void 0,w=void 0;q(["sw","s","se","nw","n","ne"],R)&&(M=(m=Math.abs(a-I))<=T),q(["nw","w","sw","ne","e","se"],R)&&(w=(b=Math.abs(r-k))<=T),W(O,{tcs:M,lcs:w},{tc:a,lc:r,x1c:k,y1c:I,margins:P,snapMargins:h}),M&&m<=E&&(q(["sw","s","se"],R)&&I<a&&B(S,"tcs",m,function(t){y.size.height=2*(t-L)},a),q(["nw","n","ne"],R)&&a<I&&B(S,"tcs",m,function(t){y.size.height=2*(j-t),y.position.top=j-y.size.height},a)),w&&b<=E&&(q(["nw","w","sw"],R)&&r<k&&B(S,"lcs",b,function(t){y.size.width=2*(_-t),y.position.left=_-y.size.width},r),q(["ne","e","se"],R)&&k<r&&B(S,"lcs",b,function(t){y.size.width=2*(t-C)},r)),"inner"!==z.snapRefMode&&(q(["sw","s","se"],R)&&(p=(d=Math.abs(s-j))<=T),q(["nw","n","ne"],R)&&(f=(v=Math.abs(o-L))<=T),q(["nw","w","sw"],R)&&(l=(g=Math.abs(i-C))<=T),q(["ne","e","se"],R)&&(c=(u=Math.abs(n-_))<=T),W(O,{ts:p,bs:f,ls:c,rs:l},{t:s,b:o,l:n,r:i,x1:C,x2:_,y1:L,y2:j,margins:P,snapMargins:h}),p&&d<=E&&B(S,"ts",d,function(t){y.size.height=t-L},s),f&&v<=E&&B(S,"bs",v,function(t){y.size.height=j-t,y.position.top=j-y.size.height},o),c&&u<=E&&B(S,"ls",u,function(t){y.size.width=t-C},n),l&&g<=E&&B(S,"rs",u,function(t){y.size.width=_-t,y.position.left=_-y.size.width},i)),"outer"!==z.snapRefMode&&(l=c=f=p=!1,q(["sw","s","se"],R)&&(f=(v=Math.abs(o-j))<=T),q(["nw","n","ne"],R)&&(p=(d=Math.abs(s-L))<=T),q(["nw","w","sw"],R)&&(c=(u=Math.abs(n-C))<=T),q(["ne","e","se"],R)&&(l=(g=Math.abs(i-_))<=T),W(O,{ts:p,bs:f,ls:c,rs:l},{t:s,b:o,l:n,r:i,x1:C,x2:_,y1:L,y2:j,margins:P,snapMargins:h}),p&&d<=E&&B(S,"ts2",d,function(t){y.size.height=j-t,y.position.top=j-y.size.height},s),f&&v<=E&&B(S,"bs2",v,function(t){y.size.height=t-L},o),c&&u<=E&&B(S,"ls2",v,function(t){y.size.width=_-t,y.position.left=_-y.size.width},n),l&&g<=E&&B(S,"rs2",v,function(t){y.size.width=t-C},i)),Object.keys(S).forEach(function(t){var e=S[t];e.cb.apply(e,e.args)});var x=y.refLineContext;x.clearRect(0,0,y.canvas.width,y.canvas.height),x.beginPath(),O.forEach(function(t){var e=t[0],n=t[1],i=t[2];x.moveTo(e.x+i.left,e.y+i.top),x.lineTo(n.x+i.left,n.y+i.top)}),x.stroke()},i=y.snapRefElements.length-1;0<=i;i-=1)n(i)},stop:function(){var t=c(this).resizable("instance");delete t.refLineContext,c(t.canvas).remove(),delete t.canvas}})});
